#startup tmux
if command -v tmux &> /dev/null && [ -z "$TMUX" ]; then
  tmux attach -t default || tmux new -s terminal-session 
fi

function aws_sso_login() {
    aws sso login --profile non-prd
    pass=$(aws ecr get-login-password --region us-east-1 --profile non-prd)
    which docker && echo $pass | docker login --username AWS --password-stdin 761885676921.dkr.ecr.us-east-1.amazonaws.com
    which podman && echo $pass | podman login --username AWS --password-stdin 761885676921.dkr.ecr.us-east-1.amazonaws.com
}

# pnpm
export PNPM_HOME="/Users/jordan.garcia/Library/pnpm"
case ":$PATH:" in
  *":$PNPM_HOME:"*) ;;
  *) export PATH="$PNPM_HOME:$PATH" ;;
esac

alias code='claude --model "bedrock-claude-sonnet-4"'
alias cc='claude --model "bedrock-claude-sonnet-4"'
alias librrtest='task test:lib-reqrepo -- --disable-warnings -q --tb=short --reuse-db'
alias rrtest='task test:reqrepo -- --disable-warnings -q --tb=short --reuse-db'
# alias librrtest='task test:lib-reqrepo -- --disable-warnings -q --tb=short'
# alias rrtest='task test:reqrepo -- --disable-warnings -q --tb=short'

alias reqrepo-env="source ~/.zshrc-modules/scripts/activate-reqrepo-env"
# Unset any existing alias before defining function
unalias black-staged 2>/dev/null || true

function black-staged {
    local py_files
    py_files=$(git diff --cached --name-only --diff-filter=AM | grep "\.py$")
    if [[ -n "$py_files" ]]; then
        echo "Running Black on staged Python files:"
        echo "$py_files" | xargs black --config pyproject.toml
    else
        echo "No staged Python files found."
    fi
}
